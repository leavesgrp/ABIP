\hypertarget{cs__house_8c_source}{}\doxysection{cs\+\_\+house.\+c}
\label{cs__house_8c_source}\index{csparse/Source/cs\_house.c@{csparse/Source/cs\_house.c}}
\mbox{\hyperlink{cs__house_8c}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{cs__house_8c_source_l00001}00001 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{cs_8h}{cs.h}}"{}}}
\DoxyCodeLine{\Hypertarget{cs__house_8c_source_l00002}00002 \textcolor{comment}{/* create a Householder reflection [v,beta,s]=house(x), overwrite x with v,}}
\DoxyCodeLine{\Hypertarget{cs__house_8c_source_l00003}00003 \textcolor{comment}{ * where (I-\/beta*v*v')*x = s*e1.  See Algo 5.1.1, Golub \& Van Loan, 3rd ed. */}}
\DoxyCodeLine{\Hypertarget{cs__house_8c_source_l00004}\mbox{\hyperlink{cs_8h_af4e2e546282433ebb90343c8535dd1fe}{00004}} \textcolor{keywordtype}{double} \mbox{\hyperlink{cs__house_8c_af4e2e546282433ebb90343c8535dd1fe}{cs\_house}} (\textcolor{keywordtype}{double} *x, \textcolor{keywordtype}{double} *beta, \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}} n)}
\DoxyCodeLine{\Hypertarget{cs__house_8c_source_l00005}00005 \{}
\DoxyCodeLine{\Hypertarget{cs__house_8c_source_l00006}00006     \textcolor{keywordtype}{double} s, sigma = 0 ;}
\DoxyCodeLine{\Hypertarget{cs__house_8c_source_l00007}00007     \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}} \mbox{\hyperlink{make__abip__qcp_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}} ;}
\DoxyCodeLine{\Hypertarget{cs__house_8c_source_l00008}00008     \textcolor{keywordflow}{if} (!x || !beta) \textcolor{keywordflow}{return} (-\/1) ;          \textcolor{comment}{/* check inputs */}}
\DoxyCodeLine{\Hypertarget{cs__house_8c_source_l00009}00009     \textcolor{keywordflow}{for} (\mbox{\hyperlink{make__abip__qcp_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}} = 1 ; \mbox{\hyperlink{make__abip__qcp_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}} < n ; \mbox{\hyperlink{make__abip__qcp_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}}++) sigma += x [\mbox{\hyperlink{make__abip__qcp_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}}] * x [\mbox{\hyperlink{make__abip__qcp_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}}] ;}
\DoxyCodeLine{\Hypertarget{cs__house_8c_source_l00010}00010     \textcolor{keywordflow}{if} (sigma == 0)}
\DoxyCodeLine{\Hypertarget{cs__house_8c_source_l00011}00011     \{}
\DoxyCodeLine{\Hypertarget{cs__house_8c_source_l00012}00012         s = fabs (x [0]) ;                  \textcolor{comment}{/* s = |x(0)| */}}
\DoxyCodeLine{\Hypertarget{cs__house_8c_source_l00013}00013         (*beta) = (x [0] <= 0) ? 2 : 0 ;}
\DoxyCodeLine{\Hypertarget{cs__house_8c_source_l00014}00014         x [0] = 1 ;}
\DoxyCodeLine{\Hypertarget{cs__house_8c_source_l00015}00015     \}}
\DoxyCodeLine{\Hypertarget{cs__house_8c_source_l00016}00016     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cs__house_8c_source_l00017}00017     \{}
\DoxyCodeLine{\Hypertarget{cs__house_8c_source_l00018}00018         s = sqrt (x [0] * x [0] + sigma) ;  \textcolor{comment}{/* s = norm (x) */}}
\DoxyCodeLine{\Hypertarget{cs__house_8c_source_l00019}00019         x [0] = (x [0] <= 0) ? (x [0] -\/ s) : (-\/sigma / (x [0] + s)) ;}
\DoxyCodeLine{\Hypertarget{cs__house_8c_source_l00020}00020         (*beta) = -\/1. / (s * x [0]) ;}
\DoxyCodeLine{\Hypertarget{cs__house_8c_source_l00021}00021     \}}
\DoxyCodeLine{\Hypertarget{cs__house_8c_source_l00022}00022     \textcolor{keywordflow}{return} (s) ;}
\DoxyCodeLine{\Hypertarget{cs__house_8c_source_l00023}00023 \}}

\end{DoxyCode}
