\hypertarget{cs__scatter_8c_source}{}\doxysection{cs\+\_\+scatter.\+c}
\label{cs__scatter_8c_source}\index{csparse/Source/cs\_scatter.c@{csparse/Source/cs\_scatter.c}}
\mbox{\hyperlink{cs__scatter_8c}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{cs__scatter_8c_source_l00001}00001 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{cs_8h}{cs.h}}"{}}}
\DoxyCodeLine{\Hypertarget{cs__scatter_8c_source_l00002}00002 \textcolor{comment}{/* x = x + beta * A(:,j), where x is a dense vector and A(:,j) is sparse */}}
\DoxyCodeLine{\Hypertarget{cs__scatter_8c_source_l00003}\mbox{\hyperlink{cs_8h_a324e7bf547ed0b969275da4410563e6e}{00003}} \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}} \mbox{\hyperlink{cs__scatter_8c_a324e7bf547ed0b969275da4410563e6e}{cs\_scatter}} (\textcolor{keyword}{const} \mbox{\hyperlink{structcs__sparse}{cs}} *A, \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}} j, \textcolor{keywordtype}{double} beta, \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}} *w, \textcolor{keywordtype}{double} *x, \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}} mark,}
\DoxyCodeLine{\Hypertarget{cs__scatter_8c_source_l00004}00004     \mbox{\hyperlink{structcs__sparse}{cs}} *C, \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}} nz)}
\DoxyCodeLine{\Hypertarget{cs__scatter_8c_source_l00005}00005 \{}
\DoxyCodeLine{\Hypertarget{cs__scatter_8c_source_l00006}00006     \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}} \mbox{\hyperlink{make__abip__qcp_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}}, p, *Ap, *Ai, *Ci ;}
\DoxyCodeLine{\Hypertarget{cs__scatter_8c_source_l00007}00007     \textcolor{keywordtype}{double} *Ax ;}
\DoxyCodeLine{\Hypertarget{cs__scatter_8c_source_l00008}00008     \textcolor{keywordflow}{if} (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}} (A) || !w || !\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}} (C)) \textcolor{keywordflow}{return} (-\/1) ;     \textcolor{comment}{/* check inputs */}}
\DoxyCodeLine{\Hypertarget{cs__scatter_8c_source_l00009}00009     Ap = A-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}} ; Ai = A-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}} ; Ax = A-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}} ; Ci = C-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}} ;}
\DoxyCodeLine{\Hypertarget{cs__scatter_8c_source_l00010}00010     \textcolor{keywordflow}{for} (p = Ap [j] ; p < Ap [j+1] ; p++)}
\DoxyCodeLine{\Hypertarget{cs__scatter_8c_source_l00011}00011     \{}
\DoxyCodeLine{\Hypertarget{cs__scatter_8c_source_l00012}00012         \mbox{\hyperlink{make__abip__qcp_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}} = Ai [p] ;                            \textcolor{comment}{/* A(i,j) is nonzero */}}
\DoxyCodeLine{\Hypertarget{cs__scatter_8c_source_l00013}00013         \textcolor{keywordflow}{if} (w [\mbox{\hyperlink{make__abip__qcp_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}}] < mark)}
\DoxyCodeLine{\Hypertarget{cs__scatter_8c_source_l00014}00014         \{}
\DoxyCodeLine{\Hypertarget{cs__scatter_8c_source_l00015}00015             w [\mbox{\hyperlink{make__abip__qcp_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}}] = mark ;                      \textcolor{comment}{/* i is new entry in column j */}}
\DoxyCodeLine{\Hypertarget{cs__scatter_8c_source_l00016}00016             Ci [nz++] = \mbox{\hyperlink{make__abip__qcp_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}} ;                     \textcolor{comment}{/* add i to pattern of C(:,j) */}}
\DoxyCodeLine{\Hypertarget{cs__scatter_8c_source_l00017}00017             \textcolor{keywordflow}{if} (x) x [\mbox{\hyperlink{make__abip__qcp_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}}] = beta * Ax [p] ;      \textcolor{comment}{/* x(i) = beta*A(i,j) */}}
\DoxyCodeLine{\Hypertarget{cs__scatter_8c_source_l00018}00018         \}}
\DoxyCodeLine{\Hypertarget{cs__scatter_8c_source_l00019}00019         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (x) x [\mbox{\hyperlink{make__abip__qcp_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}}] += beta * Ax [p] ;    \textcolor{comment}{/* i exists in C(:,j) already */}}
\DoxyCodeLine{\Hypertarget{cs__scatter_8c_source_l00020}00020     \}}
\DoxyCodeLine{\Hypertarget{cs__scatter_8c_source_l00021}00021     \textcolor{keywordflow}{return} (nz) ;}
\DoxyCodeLine{\Hypertarget{cs__scatter_8c_source_l00022}00022 \}}

\end{DoxyCode}
