\hypertarget{qdldl_8h}{}\doxysection{qdldl/include/qdldl.h File Reference}
\label{qdldl_8h}\index{qdldl/include/qdldl.h@{qdldl/include/qdldl.h}}
{\ttfamily \#include \char`\"{}qdldl\+\_\+types.\+h\char`\"{}}\newline
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} \mbox{\hyperlink{qdldl_8h_ab6073eb3c57c7de1d3ff34660bfbea5d}{QDLDL\+\_\+etree}} (const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} n, const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$Ap, const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$Ai, \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$work, \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$Lnz, \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$etree)
\item 
\mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} \mbox{\hyperlink{qdldl_8h_afb0d66c8d79bf61800805af3cb7740f3}{QDLDL\+\_\+factor}} (const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} n, const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$Ap, const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$Ai, const \mbox{\hyperlink{qdldl__types_8h_a92d3691c5ccda7049c33d00c63ba7d7d}{QDLDL\+\_\+float}} $\ast$Ax, \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$Lp, \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$Li, \mbox{\hyperlink{qdldl__types_8h_a92d3691c5ccda7049c33d00c63ba7d7d}{QDLDL\+\_\+float}} $\ast$Lx, \mbox{\hyperlink{qdldl__types_8h_a92d3691c5ccda7049c33d00c63ba7d7d}{QDLDL\+\_\+float}} $\ast$D, \mbox{\hyperlink{qdldl__types_8h_a92d3691c5ccda7049c33d00c63ba7d7d}{QDLDL\+\_\+float}} $\ast$Dinv, const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$Lnz, const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$etree, \mbox{\hyperlink{qdldl__types_8h_a58d5afed3632489e60573125142d1212}{QDLDL\+\_\+bool}} $\ast$bwork, \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$iwork, \mbox{\hyperlink{qdldl__types_8h_a92d3691c5ccda7049c33d00c63ba7d7d}{QDLDL\+\_\+float}} $\ast$fwork)
\item 
void \mbox{\hyperlink{qdldl_8h_a8cac09620d52e066bb429088fdf1c328}{QDLDL\+\_\+solve}} (const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} n, const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$Lp, const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$Li, const \mbox{\hyperlink{qdldl__types_8h_a92d3691c5ccda7049c33d00c63ba7d7d}{QDLDL\+\_\+float}} $\ast$Lx, const \mbox{\hyperlink{qdldl__types_8h_a92d3691c5ccda7049c33d00c63ba7d7d}{QDLDL\+\_\+float}} $\ast$Dinv, \mbox{\hyperlink{qdldl__types_8h_a92d3691c5ccda7049c33d00c63ba7d7d}{QDLDL\+\_\+float}} $\ast$x)
\item 
void \mbox{\hyperlink{qdldl_8h_a84ba3f6e32639f67ae274bbb9556f802}{QDLDL\+\_\+\+Lsolve}} (const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} n, const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$Lp, const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$Li, const \mbox{\hyperlink{qdldl__types_8h_a92d3691c5ccda7049c33d00c63ba7d7d}{QDLDL\+\_\+float}} $\ast$Lx, \mbox{\hyperlink{qdldl__types_8h_a92d3691c5ccda7049c33d00c63ba7d7d}{QDLDL\+\_\+float}} $\ast$x)
\item 
void \mbox{\hyperlink{qdldl_8h_af00376940f684cce1f0595dbe7171eef}{QDLDL\+\_\+\+Ltsolve}} (const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} n, const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$Lp, const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$Li, const \mbox{\hyperlink{qdldl__types_8h_a92d3691c5ccda7049c33d00c63ba7d7d}{QDLDL\+\_\+float}} $\ast$Lx, \mbox{\hyperlink{qdldl__types_8h_a92d3691c5ccda7049c33d00c63ba7d7d}{QDLDL\+\_\+float}} $\ast$x)
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{qdldl_8h_ab6073eb3c57c7de1d3ff34660bfbea5d}\label{qdldl_8h_ab6073eb3c57c7de1d3ff34660bfbea5d}} 
\index{qdldl.h@{qdldl.h}!QDLDL\_etree@{QDLDL\_etree}}
\index{QDLDL\_etree@{QDLDL\_etree}!qdldl.h@{qdldl.h}}
\doxysubsubsection{\texorpdfstring{QDLDL\_etree()}{QDLDL\_etree()}}
{\footnotesize\ttfamily \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} QDLDL\+\_\+etree (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}}}]{n,  }\item[{const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$}]{Ap,  }\item[{const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$}]{Ai,  }\item[{\mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$}]{work,  }\item[{\mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$}]{Lnz,  }\item[{\mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$}]{etree }\end{DoxyParamCaption})}

Compute the elimination tree for a quasidefinite matrix in compressed sparse column form, where the input matrix is assumed to contain data for the upper triangular part of A only, and there are no duplicate indices.

Returns an elimination tree for the factorization A = LDL$^\wedge$T and a count of the nonzeros in each column of L that are strictly below the diagonal.

Does not use MALLOC. It is assumed that the arrays work, Lnz, and etree will be allocated with a number of elements equal to n.

The data in (n,Ap,Ai) are from a square matrix A in CSC format, and should include the upper triangular part of A only.

This function is only intended for factorisation of QD matrices specified by their upper triangular part. An error is returned if any column has data below the diagonal or s completely empty.

For matrices with a non-\/empty column but a zero on the corresponding diagonal, this function will {\itshape not} return an error, as it may still be possible to factor such a matrix in LDL form. No promises are made in this case though...


\begin{DoxyParams}{Parameters}
{\em n} & number of columns in CSC matrix A (assumed square) \\
\hline
{\em Ap} & column pointers (size n+1) for columns of A \\
\hline
{\em Ai} & row indices of A. Has Ap\mbox{[}n\mbox{]} elements \\
\hline
{\em work} & work vector (size n) (no meaning on return) \\
\hline
{\em Lnz} & count of nonzeros in each column of L (size n) below diagonal \\
\hline
{\em etree} & elimination tree (size n) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
total sum of Lnz (i.\+e. total nonzeros in L below diagonal). Returns -\/1 if the input is not triu or has an empty column. Returns -\/2 if the return value overflows QDLDL\+\_\+int. 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{qdldl_8c_source_l00011}{11}} of file \mbox{\hyperlink{qdldl_8c_source}{qdldl.\+c}}.

\mbox{\Hypertarget{qdldl_8h_afb0d66c8d79bf61800805af3cb7740f3}\label{qdldl_8h_afb0d66c8d79bf61800805af3cb7740f3}} 
\index{qdldl.h@{qdldl.h}!QDLDL\_factor@{QDLDL\_factor}}
\index{QDLDL\_factor@{QDLDL\_factor}!qdldl.h@{qdldl.h}}
\doxysubsubsection{\texorpdfstring{QDLDL\_factor()}{QDLDL\_factor()}}
{\footnotesize\ttfamily \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} QDLDL\+\_\+factor (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}}}]{n,  }\item[{const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$}]{Ap,  }\item[{const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$}]{Ai,  }\item[{const \mbox{\hyperlink{qdldl__types_8h_a92d3691c5ccda7049c33d00c63ba7d7d}{QDLDL\+\_\+float}} $\ast$}]{Ax,  }\item[{\mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$}]{Lp,  }\item[{\mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$}]{Li,  }\item[{\mbox{\hyperlink{qdldl__types_8h_a92d3691c5ccda7049c33d00c63ba7d7d}{QDLDL\+\_\+float}} $\ast$}]{Lx,  }\item[{\mbox{\hyperlink{qdldl__types_8h_a92d3691c5ccda7049c33d00c63ba7d7d}{QDLDL\+\_\+float}} $\ast$}]{D,  }\item[{\mbox{\hyperlink{qdldl__types_8h_a92d3691c5ccda7049c33d00c63ba7d7d}{QDLDL\+\_\+float}} $\ast$}]{Dinv,  }\item[{const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$}]{Lnz,  }\item[{const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$}]{etree,  }\item[{\mbox{\hyperlink{qdldl__types_8h_a58d5afed3632489e60573125142d1212}{QDLDL\+\_\+bool}} $\ast$}]{bwork,  }\item[{\mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$}]{iwork,  }\item[{\mbox{\hyperlink{qdldl__types_8h_a92d3691c5ccda7049c33d00c63ba7d7d}{QDLDL\+\_\+float}} $\ast$}]{fwork }\end{DoxyParamCaption})}

Compute an LDL decomposition for a quasidefinite matrix in compressed sparse column form, where the input matrix is assumed to contain data for the upper triangular part of A only, and there are no duplicate indices.

Returns factors L, D and Dinv = 1./D.

Does not use MALLOC. It is assumed that L will be a compressed sparse column matrix with data (n,Lp,Li,Lx) with sufficient space allocated, with a number of nonzeros equal to the count given as a return value by QDLDL\+\_\+etree


\begin{DoxyParams}{Parameters}
{\em n} & number of columns in L and A (both square) \\
\hline
{\em Ap} & column pointers (size n+1) for columns of A (not modified) \\
\hline
{\em Ai} & row indices of A. Has Ap\mbox{[}n\mbox{]} elements (not modified) \\
\hline
{\em Ax} & data of A. Has Ap\mbox{[}n\mbox{]} elements (not modified) \\
\hline
{\em Lp} & column pointers (size n+1) for columns of L \\
\hline
{\em Li} & row indices of L. Has Lp\mbox{[}n\mbox{]} elements \\
\hline
{\em Lx} & data of L. Has Lp\mbox{[}n\mbox{]} elements \\
\hline
{\em D} & vectorized factor D. Length is n \\
\hline
{\em Dinv} & reciprocal of D. Length is n \\
\hline
{\em Lnz} & count of nonzeros in each column of L below diagonal, as given by QDLDL\+\_\+etree (not modified) \\
\hline
{\em etree} & elimination tree as as given by QDLDL\+\_\+etree (not modified) \\
\hline
{\em bwork} & working array of bools. Length is n \\
\hline
{\em iwork} & working array of integers. Length is 3$\ast$n \\
\hline
{\em fwork} & working array of floats. Length is n \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns a count of the number of positive elements in D. Returns -\/1 and exits immediately if any element of D evaluates exactly to zero (matrix is not quasidefinite or otherwise LDL factorisable) 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{qdldl_8c_source_l00072}{72}} of file \mbox{\hyperlink{qdldl_8c_source}{qdldl.\+c}}.

\mbox{\Hypertarget{qdldl_8h_a84ba3f6e32639f67ae274bbb9556f802}\label{qdldl_8h_a84ba3f6e32639f67ae274bbb9556f802}} 
\index{qdldl.h@{qdldl.h}!QDLDL\_Lsolve@{QDLDL\_Lsolve}}
\index{QDLDL\_Lsolve@{QDLDL\_Lsolve}!qdldl.h@{qdldl.h}}
\doxysubsubsection{\texorpdfstring{QDLDL\_Lsolve()}{QDLDL\_Lsolve()}}
{\footnotesize\ttfamily void QDLDL\+\_\+\+Lsolve (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}}}]{n,  }\item[{const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$}]{Lp,  }\item[{const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$}]{Li,  }\item[{const \mbox{\hyperlink{qdldl__types_8h_a92d3691c5ccda7049c33d00c63ba7d7d}{QDLDL\+\_\+float}} $\ast$}]{Lx,  }\item[{\mbox{\hyperlink{qdldl__types_8h_a92d3691c5ccda7049c33d00c63ba7d7d}{QDLDL\+\_\+float}} $\ast$}]{x }\end{DoxyParamCaption})}

Solves (L+I)x = b

It is assumed that L will be a compressed sparse column matrix with data (n,Lp,Li,Lx).


\begin{DoxyParams}{Parameters}
{\em n} & number of columns in L \\
\hline
{\em Lp} & column pointers (size n+1) for columns of L \\
\hline
{\em Li} & row indices of L. Has Lp\mbox{[}n\mbox{]} elements \\
\hline
{\em Lx} & data of L. Has Lp\mbox{[}n\mbox{]} elements \\
\hline
{\em x} & initialized to b. Equal to x on return \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{qdldl_8c_source_l00236}{236}} of file \mbox{\hyperlink{qdldl_8c_source}{qdldl.\+c}}.

\mbox{\Hypertarget{qdldl_8h_af00376940f684cce1f0595dbe7171eef}\label{qdldl_8h_af00376940f684cce1f0595dbe7171eef}} 
\index{qdldl.h@{qdldl.h}!QDLDL\_Ltsolve@{QDLDL\_Ltsolve}}
\index{QDLDL\_Ltsolve@{QDLDL\_Ltsolve}!qdldl.h@{qdldl.h}}
\doxysubsubsection{\texorpdfstring{QDLDL\_Ltsolve()}{QDLDL\_Ltsolve()}}
{\footnotesize\ttfamily void QDLDL\+\_\+\+Ltsolve (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}}}]{n,  }\item[{const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$}]{Lp,  }\item[{const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$}]{Li,  }\item[{const \mbox{\hyperlink{qdldl__types_8h_a92d3691c5ccda7049c33d00c63ba7d7d}{QDLDL\+\_\+float}} $\ast$}]{Lx,  }\item[{\mbox{\hyperlink{qdldl__types_8h_a92d3691c5ccda7049c33d00c63ba7d7d}{QDLDL\+\_\+float}} $\ast$}]{x }\end{DoxyParamCaption})}

Solves (L+I)\textquotesingle{}x = b

It is assumed that L will be a compressed sparse column matrix with data (n,Lp,Li,Lx).


\begin{DoxyParams}{Parameters}
{\em n} & number of columns in L \\
\hline
{\em Lp} & column pointers (size n+1) for columns of L \\
\hline
{\em Li} & row indices of L. Has Lp\mbox{[}n\mbox{]} elements \\
\hline
{\em Lx} & data of L. Has Lp\mbox{[}n\mbox{]} elements \\
\hline
{\em x} & initialized to b. Equal to x on return \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{qdldl_8c_source_l00252}{252}} of file \mbox{\hyperlink{qdldl_8c_source}{qdldl.\+c}}.

\mbox{\Hypertarget{qdldl_8h_a8cac09620d52e066bb429088fdf1c328}\label{qdldl_8h_a8cac09620d52e066bb429088fdf1c328}} 
\index{qdldl.h@{qdldl.h}!QDLDL\_solve@{QDLDL\_solve}}
\index{QDLDL\_solve@{QDLDL\_solve}!qdldl.h@{qdldl.h}}
\doxysubsubsection{\texorpdfstring{QDLDL\_solve()}{QDLDL\_solve()}}
{\footnotesize\ttfamily void QDLDL\+\_\+solve (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}}}]{n,  }\item[{const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$}]{Lp,  }\item[{const \mbox{\hyperlink{qdldl__types_8h_ae11ba65646333405250d5be400094f83}{QDLDL\+\_\+int}} $\ast$}]{Li,  }\item[{const \mbox{\hyperlink{qdldl__types_8h_a92d3691c5ccda7049c33d00c63ba7d7d}{QDLDL\+\_\+float}} $\ast$}]{Lx,  }\item[{const \mbox{\hyperlink{qdldl__types_8h_a92d3691c5ccda7049c33d00c63ba7d7d}{QDLDL\+\_\+float}} $\ast$}]{Dinv,  }\item[{\mbox{\hyperlink{qdldl__types_8h_a92d3691c5ccda7049c33d00c63ba7d7d}{QDLDL\+\_\+float}} $\ast$}]{x }\end{DoxyParamCaption})}

Solves LDL\textquotesingle{}x = b

It is assumed that L will be a compressed sparse column matrix with data (n,Lp,Li,Lx).


\begin{DoxyParams}{Parameters}
{\em n} & number of columns in L \\
\hline
{\em Lp} & column pointers (size n+1) for columns of L \\
\hline
{\em Li} & row indices of L. Has Lp\mbox{[}n\mbox{]} elements \\
\hline
{\em Lx} & data of L. Has Lp\mbox{[}n\mbox{]} elements \\
\hline
{\em Dinv} & reciprocal of D. Length is n \\
\hline
{\em x} & initialized to b. Equal to x on return \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{qdldl_8c_source_l00269}{269}} of file \mbox{\hyperlink{qdldl_8c_source}{qdldl.\+c}}.

